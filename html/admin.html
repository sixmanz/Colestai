<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLIPS Admin Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#003366',
                        'secondary': '#56C4E8',
                        'blue-primary': '#003366',
                        'sky-primary': '#56C4E8',
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans Thai', 'sans-serif'],
                        thai: ['Noto Sans Thai', 'Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Inter', 'Noto Sans Thai', sans-serif;
        }

        .sidebar-link.active {
            background: rgba(0, 51, 102, 0.05);
            color: #003366;
            font-weight: 500;
        }

        .sidebar-link.active i {
            color: #003366;
        }
    </style>
</head>

<body class="bg-gray-50 text-slate-800 overflow-hidden">

    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-56 bg-white border-r border-gray-100 flex flex-col">
            <!-- Logo -->
            <div class="p-5 border-b border-gray-100">
                <div class="flex items-center gap-2">
                    <img src="../images/logo_new.png" alt="Logo" class="h-7">
                    <span class="text-xs font-semibold text-slate-400 uppercase tracking-wider">Admin</span>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="flex-1 p-3 space-y-1 overflow-y-auto">
                <button onclick="switchTab('dashboard')" id="nav-dashboard"
                    class="sidebar-link active w-full text-left px-3 py-2.5 rounded-lg text-slate-500 hover:bg-gray-50 transition-all flex items-center gap-2.5 text-sm">
                    <i class="fas fa-chart-line w-4 text-slate-400"></i>
                    <span data-i18n="admin_dashboard">Dashboard</span>
                </button>
                <button onclick="switchTab('privileges')" id="nav-privileges"
                    class="sidebar-link w-full text-left px-3 py-2.5 rounded-lg text-slate-500 hover:bg-gray-50 transition-all flex items-center gap-2.5 text-sm">
                    <i class="fas fa-gift w-4 text-slate-400"></i>
                    <span data-i18n="admin_privileges">Privileges</span>
                </button>
                <button onclick="switchTab('orders')" id="nav-orders"
                    class="sidebar-link w-full text-left px-3 py-2.5 rounded-lg text-slate-500 hover:bg-gray-50 transition-all flex items-center gap-2.5 text-sm">
                    <i class="fas fa-shopping-bag w-4 text-slate-400"></i>
                    <span data-i18n="admin_orders">Orders</span>
                    <span id="pendingCount"
                        class="ml-auto bg-blue-100 text-blue-600 text-xs px-1.5 py-0.5 rounded-full font-medium">0</span>
                </button>
            </nav>

            <!-- Exit -->
            <div class="p-3 border-t border-gray-100">
                <a href="index.html"
                    class="flex items-center gap-2.5 px-3 py-2.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all text-sm">
                    <i class="fas fa-sign-out-alt w-4"></i>
                    <span data-i18n="admin_exit">Exit</span>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto bg-gray-50">
            <!-- Topbar -->
            <header
                class="h-14 bg-white border-b border-gray-100 flex items-center justify-between px-6 sticky top-0 z-10">
                <h2 id="pageTitle" class="text-base font-semibold text-slate-800" data-i18n="admin_overview">Dashboard
                </h2>
                <div class="flex items-center gap-3">
                    <button onclick="toggleAdminLanguage()"
                        class="flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-slate-500 hover:bg-gray-50 transition-all text-xs font-medium">
                        <i class="fas fa-globe text-slate-400"></i>
                        <span id="currentLang">EN</span>
                    </button>
                    <div class="flex items-center gap-2 pl-3 border-l border-gray-100">
                        <img src="../images/profile_v1.jpg" class="w-7 h-7 rounded-full">
                        <span class="text-xs text-slate-600">Admin</span>
                    </div>
                </div>
            </header>

            <div class="p-6">
                <!-- VIEW: DASHBOARD -->
                <div id="view-dashboard" class="space-y-5">
                    <!-- Stats Cards -->
                    <div class="grid grid-cols-3 gap-4">
                        <div class="bg-white rounded-xl p-4 border border-gray-100">
                            <div class="flex items-center justify-between mb-3">
                                <div class="w-9 h-9 bg-blue-50 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-gift text-blue-500 text-sm"></i>
                                </div>
                                <span class="text-green-500 text-xs font-medium"><i
                                        class="fas fa-arrow-up mr-0.5"></i>Active</span>
                            </div>
                            <p class="text-slate-500 text-xs mb-0.5" data-i18n="stat_total_privileges">Privileges</p>
                            <h3 class="text-2xl font-bold text-slate-800" id="statTotalPrivileges">0</h3>
                        </div>
                        <div class="bg-white rounded-xl p-4 border border-gray-100">
                            <div class="flex items-center justify-between mb-3">
                                <div class="w-9 h-9 bg-sky-50 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-ticket-alt text-sky-500 text-sm"></i>
                                </div>
                            </div>
                            <p class="text-slate-500 text-xs mb-0.5" data-i18n="stat_total_redemptions">Redemptions</p>
                            <h3 class="text-2xl font-bold text-slate-800" id="statTotalRedemptions">0</h3>
                        </div>
                        <div class="bg-white rounded-xl p-4 border border-gray-100">
                            <div class="flex items-center justify-between mb-3">
                                <div class="w-9 h-9 bg-amber-50 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-clock text-amber-500 text-sm"></i>
                                </div>
                                <span class="text-amber-500 text-xs font-medium">Pending</span>
                            </div>
                            <p class="text-slate-500 text-xs mb-0.5" data-i18n="stat_pending">Pending</p>
                            <h3 class="text-2xl font-bold text-slate-800" id="statPendingOrders">0</h3>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white rounded-xl p-5 border border-gray-100">
                        <h3 class="font-semibold text-sm text-slate-800 mb-4" data-i18n="stat_recent_activity">Recent
                            Activity</h3>
                        <div id="recentActivityList" class="space-y-3 text-sm">
                            <!-- Injected JS -->
                        </div>
                    </div>
                </div>

                <!-- VIEW: PRIVILEGES -->
                <div id="view-privileges" class="hidden space-y-5">
                    <!-- Toolbar -->
                    <div class="flex flex-wrap justify-between items-center gap-3">
                        <div class="flex items-center gap-3">
                            <!-- Search -->
                            <div class="bg-white rounded-lg flex items-center px-3 py-2 border border-gray-200 w-56">
                                <i class="fas fa-search text-gray-400 mr-2 text-sm"></i>
                                <input oninput="searchAdminPrivileges(this.value)" type="text" placeholder="Search..."
                                    class="bg-transparent outline-none text-slate-800 w-full placeholder-gray-400 text-sm">
                            </div>
                            <!-- Filter -->
                            <select onchange="filterByCategory(this.value)"
                                class="bg-white border border-gray-200 rounded-lg text-sm px-3 py-2 outline-none focus:border-blue-400 text-slate-600">
                                <option value="all">All Categories</option>
                                <option value="movie-tickets">Movie Tickets</option>
                                <option value="in-game-items">In-game Items</option>
                                <option value="goods">Goods</option>
                                <option value="travel">Travel</option>
                                <option value="hospitality">Hospitality</option>
                                <option value="meet-greet">Meet & Greet</option>
                            </select>
                            <!-- Sort -->
                            <select onchange="sortPrivileges(this.value)"
                                class="bg-white border border-gray-200 rounded-lg text-sm px-3 py-2 outline-none focus:border-blue-400 text-slate-600">
                                <option value="newest">Newest First</option>
                                <option value="name">Name A-Z</option>
                                <option value="price-high">Price: High-Low</option>
                                <option value="price-low">Price: Low-High</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-2">
                            <!-- Export/Import -->
                            <button onclick="exportData()" title="Export Data"
                                class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm text-slate-600 transition-colors flex items-center gap-2">
                                <i class="fas fa-download text-xs"></i>
                                <span class="hidden sm:inline">Export</span>
                            </button>
                            <button onclick="importData()" title="Import Data"
                                class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm text-slate-600 transition-colors flex items-center gap-2">
                                <i class="fas fa-upload text-xs"></i>
                                <span class="hidden sm:inline">Import</span>
                            </button>
                            <!-- Add New -->
                            <button onclick="openEditModal()"
                                class="px-4 py-2 bg-blue-primary text-white hover:bg-blue-800 rounded-lg text-sm font-medium transition-colors flex items-center gap-2">
                                <i class="fas fa-plus text-xs"></i>
                                <span>Add New</span>
                            </button>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl overflow-hidden border border-gray-100">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 text-slate-500 text-xs uppercase tracking-wider">
                                <tr>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_id">ID</th>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_privilege">Name</th>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_category">Category</th>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_price">Price</th>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_type">Type</th>
                                    <th class="px-4 py-3 font-medium text-right" data-i18n="table_actions">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminPrivilegesTable" class="divide-y divide-gray-50 text-sm text-slate-600">
                                <!-- JS Injected -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- VIEW: ORDERS -->
                <div id="view-orders" class="hidden space-y-5">
                    <div class="bg-white rounded-xl overflow-hidden border border-gray-100">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 text-slate-500 text-xs uppercase tracking-wider">
                                <tr>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_order_id">Order</th>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_item">Item</th>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_user">User</th>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_date">Date</th>
                                    <th class="px-4 py-3 font-medium" data-i18n="table_status">Status</th>
                                    <th class="px-4 py-3 font-medium text-right" data-i18n="table_actions">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminOrdersTable" class="divide-y divide-gray-50 text-sm text-slate-600">
                                <!-- JS Injected -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit Privilege Modal -->
    <div id="editModal"
        class="fixed inset-0 z-50 hidden bg-black/40 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-white rounded-xl w-full max-w-lg max-h-[85vh] overflow-y-auto shadow-xl">
            <div class="p-4 border-b border-gray-100 flex justify-between items-center sticky top-0 bg-white">
                <h3 class="font-semibold text-slate-800" id="editModalTitle">Add Privilege</h3>
                <button onclick="closeEditModal()" class="text-gray-400 hover:text-slate-600 p-1">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form onsubmit="savePrivilege(event)" class="p-4 space-y-4">
                <input type="hidden" id="editId">

                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-slate-500 text-xs mb-1" data-i18n="label_title_en">Title (EN)</label>
                        <input type="text" id="editTitle" required
                            class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 outline-none focus:border-blue-400 text-sm text-slate-800">
                    </div>
                    <div>
                        <label class="block text-slate-500 text-xs mb-1" data-i18n="label_title_th">Title (TH)</label>
                        <input type="text" id="editTitleTh" required
                            class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 outline-none focus:border-blue-400 text-sm text-slate-800">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-slate-500 text-xs mb-1" data-i18n="table_category">Category</label>
                        <select id="editCategory"
                            class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 outline-none focus:border-blue-400 text-sm text-slate-800">
                            <option value="goods">Goods</option>
                            <option value="travel">Travel</option>
                            <option value="hospitality">Hospitality</option>
                            <option value="movie-tickets">Movie Tickets</option>
                            <option value="meet-greet">Meet & Greet</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-slate-500 text-xs mb-1" data-i18n="table_price">Price (RDS)</label>
                        <input type="number" id="editPrice" required
                            class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 outline-none focus:border-blue-400 text-sm text-slate-800">
                    </div>
                </div>

                <div>
                    <label class="block text-slate-500 text-xs mb-1">Image URL</label>
                    <input type="text" id="editImage" placeholder="images/..."
                        class="w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 outline-none focus:border-blue-400 text-sm text-slate-800">
                </div>

                <div class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg">
                    <input type="checkbox" id="editIsPhysical"
                        class="w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                    <label for="editIsPhysical" class="select-none cursor-pointer text-sm text-slate-600"
                        data-i18n="label_is_physical">Physical Item</label>
                </div>

                <div class="grid grid-cols-2 gap-3 pt-3 border-t border-gray-100">
                    <button type="button" onclick="closeEditModal()"
                        class="py-2 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors text-slate-600 text-sm"
                        data-i18n="btn_cancel">Cancel</button>
                    <button type="submit"
                        class="py-2 rounded-lg bg-blue-primary text-white hover:bg-blue-800 font-medium transition-colors text-sm"
                        data-i18n="btn_save">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal"
        class="fixed inset-0 z-50 hidden bg-black/40 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-white rounded-xl w-full max-w-sm shadow-xl p-6 text-center">
            <div class="w-14 h-14 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-trash text-red-500 text-xl"></i>
            </div>
            <h3 class="font-semibold text-slate-800 mb-2">Delete Privilege?</h3>
            <p class="text-sm text-slate-500 mb-6">This action cannot be undone. Are you sure you want to delete this
                item?</p>
            <div class="flex gap-3">
                <button onclick="closeDeleteModal()"
                    class="flex-1 py-2 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors text-slate-600 text-sm">
                    Cancel
                </button>
                <button onclick="confirmDeleteAction()"
                    class="flex-1 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600 font-medium transition-colors text-sm">
                    Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../js/translations.js?v=23"></script>
    <script src="../js/data.js?v=23"></script>
    <script src="../js/privileges-data.js?v=23"></script>
    <script src="../js/utils.js?v=23"></script>
    <script src="../js/admin.js?v=23"></script>
</body>

</html>